<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Models for discrete data: counts, scales, and frequencies – Advanced Quantitative Methods for Linguistic Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week13.html" rel="next">
<link href="./week11.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week12.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Models for discrete data: counts, scales, and frequencies</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Quantitative Methods for Linguistic Data</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bayesian basics 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bayesian basics 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayesian Regression Models 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Regression Models 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bayesian Hierarchical Models 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Bayesian Hierarchical Models 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bayesian Hierarchical Models 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week12.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Models for discrete data: counts, scales, and frequencies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multivariate models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Generalized Additive Models (GAMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Generalized additive mixed-effects models (GAMMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayesian_gamms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian GAMs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDA_edited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Functional principal components analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preliminaries" id="toc-preliminaries" class="nav-link active" data-scroll-target="#preliminaries"><span class="header-section-number">8.1</span> Preliminaries</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">8.2</span> Data</a>
  <ul class="collapse">
  <li><a href="#sec-dd1-dyads" id="toc-sec-dd1-dyads" class="nav-link" data-scroll-target="#sec-dd1-dyads"><span class="header-section-number">8.2.1</span> Dyads</a></li>
  <li><a href="#dutch-verb-etymology" id="toc-dutch-verb-etymology" class="nav-link" data-scroll-target="#dutch-verb-etymology"><span class="header-section-number">8.2.2</span> Dutch verb etymology</a></li>
  <li><a href="#idioms" id="toc-idioms" class="nav-link" data-scroll-target="#idioms"><span class="header-section-number">8.2.3</span> Idioms</a></li>
  <li><a href="#dutch-verb-regularity" id="toc-dutch-verb-regularity" class="nav-link" data-scroll-target="#dutch-verb-regularity"><span class="header-section-number">8.2.4</span> Dutch verb <code>regularity</code></a></li>
  </ul></li>
  <li><a href="#poisson-and-negative-binomial-mixed-effects-models" id="toc-poisson-and-negative-binomial-mixed-effects-models" class="nav-link" data-scroll-target="#poisson-and-negative-binomial-mixed-effects-models"><span class="header-section-number">8.3</span> Poisson and negative binomial mixed-effects models</a>
  <ul class="collapse">
  <li><a href="#sec-dd1-poisson" id="toc-sec-dd1-poisson" class="nav-link" data-scroll-target="#sec-dd1-poisson"><span class="header-section-number">8.3.1</span> Poisson</a></li>
  <li><a href="#negative-binomial" id="toc-negative-binomial" class="nav-link" data-scroll-target="#negative-binomial"><span class="header-section-number">8.3.2</span> Negative binomial</a></li>
  </ul></li>
  <li><a href="#ordinal-models" id="toc-ordinal-models" class="nav-link" data-scroll-target="#ordinal-models"><span class="header-section-number">8.4</span> Ordinal models</a>
  <ul class="collapse">
  <li><a href="#sec-dd1-ordinal1" id="toc-sec-dd1-ordinal1" class="nav-link" data-scroll-target="#sec-dd1-ordinal1"><span class="header-section-number">8.4.1</span> Without random effects: <code>etymology</code></a></li>
  <li><a href="#ordinal-regression-with-random-effects" id="toc-ordinal-regression-with-random-effects" class="nav-link" data-scroll-target="#ordinal-regression-with-random-effects"><span class="header-section-number">8.4.2</span> Ordinal regression with random effects</a></li>
  </ul></li>
  <li><a href="#multinomial-models" id="toc-multinomial-models" class="nav-link" data-scroll-target="#multinomial-models"><span class="header-section-number">8.5</span> Multinomial models</a>
  <ul class="collapse">
  <li><a href="#without-random-effectgs-regularity" id="toc-without-random-effectgs-regularity" class="nav-link" data-scroll-target="#without-random-effectgs-regularity"><span class="header-section-number">8.5.1</span> Without random effectgs: <code>regularity</code></a></li>
  </ul></li>
  <li><a href="#extra" id="toc-extra" class="nav-link" data-scroll-target="#extra"><span class="header-section-number">8.6</span> Extra</a>
  <ul class="collapse">
  <li><a href="#frequentist-poisson-mixed-effects-model" id="toc-frequentist-poisson-mixed-effects-model" class="nav-link" data-scroll-target="#frequentist-poisson-mixed-effects-model"><span class="header-section-number">8.6.1</span> Frequentist Poisson mixed-effects model</a></li>
  <li><a href="#frequentist-ordinal-model" id="toc-frequentist-ordinal-model" class="nav-link" data-scroll-target="#frequentist-ordinal-model"><span class="header-section-number">8.6.2</span> Frequentist ordinal model</a></li>
  <li><a href="#sec-dd1-extra-ordinal" id="toc-sec-dd1-extra-ordinal" class="nav-link" data-scroll-target="#sec-dd1-extra-ordinal"><span class="header-section-number">8.6.3</span> Ordinal model with category-specific effects</a></li>
  <li><a href="#sec-dd1-extra-multinomial" id="toc-sec-dd1-extra-multinomial" class="nav-link" data-scroll-target="#sec-dd1-extra-multinomial"><span class="header-section-number">8.6.4</span> Frequentist multinomial model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-dd-1" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Models for discrete data: counts, scales, and frequencies</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>These lecture notes cover topics from:</p>
<ul>
<li><span class="citation" data-cites="winter2021poisson">Winter and Bürkner (<a href="references.html#ref-winter2021poisson" role="doc-biblioref">2021</a>)</span>, especially Sec. 3.3 on</li>
<li><span class="citation" data-cites="mcelreath2020statistical">McElreath (<a href="references.html#ref-mcelreath2020statistical" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="kurz2021statistical">Kurz (<a href="references.html#ref-kurz2021statistical" role="doc-biblioref">2023</a>)</span>: Sec. 12.3</li>
<li><span class="citation" data-cites="levshina2015linguistics">Levshina (<a href="references.html#ref-levshina2015linguistics" role="doc-biblioref">2015</a>)</span>, 13.1-13.2.2</li>
</ul>
<p>The <span class="citation" data-cites="winter2021poisson">Winter and Bürkner (<a href="references.html#ref-winter2021poisson" role="doc-biblioref">2021</a>)</span> reading builds on <a href="week3.html#sec-bb2-poisson" class="quarto-xref"><span>Section 2.5.2</span></a>, <a href="week3.html#sec-bb2-nb" class="quarto-xref"><span>Section 2.5.4</span></a> on Poisson and negative binomial regression. The <span class="citation" data-cites="levshina2015linguistics">Levshina (<a href="references.html#ref-levshina2015linguistics" role="doc-biblioref">2015</a>)</span> reading covers <em>frequentist</em> multinomial regression, briefly but clearly. I wasn’t able to find a sufficiently short and clear source for Bayesian multinomial regression. Readings covering the topic in more detail are <span class="citation" data-cites="barreda2023bayesian">Barreda and Silbert (<a href="references.html#ref-barreda2023bayesian" role="doc-biblioref">2023</a>)</span> Sec. 12.2, or <span class="citation" data-cites="mcelreath2020statistical">McElreath (<a href="references.html#ref-mcelreath2020statistical" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="kurz2021statistical">Kurz (<a href="references.html#ref-kurz2021statistical" role="doc-biblioref">2023</a>)</span> Sec. 11.3.</p>
<p>Topics:</p>
<ul>
<li>Poisson and negative binomial regression
<ul>
<li>Offsets, random effects</li>
</ul></li>
<li>Ordinal regression</li>
<li>Multinomial regression</li>
</ul>
<section id="preliminaries" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="preliminaries"><span class="header-section-number">8.1</span> Preliminaries</h2>
<p>Load libraries we will need:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arm)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(languageR)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlogit)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## needed for cut2()</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># avoids bug where select from MASS is used</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practical notes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>If you have loaded <code>rethinking</code>, you need to detach it before using brms. See <span class="citation" data-cites="kurz2021statistical">Kurz (<a href="references.html#ref-kurz2021statistical" role="doc-biblioref">2023</a>)</span> Sec. 4.3.1.</p></li>
<li><p>I use the <code>file</code> argument when fitting <code>brms</code> models to make compiling this document easier (so the models don’t refit every time I compile). You may or may not want to do this for your own models. See <code>file</code> and <code>file_refit</code> arguments in <code>?brm</code>.</p></li>
<li><p>Here I set the <code>file_refit</code> option so “brms will refit the model if model, data or algorithm as passed to Stan differ from what is stored in the file.”</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.file_refit =</span> <span class="st">"on_change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li><p>I use <code>chains = 4, cores = 4</code> when fitting <code>brm</code> models below—this means 4 chains, each to be run on one core on my laptop. <code>cores = 4</code> may need to be adjusted for your computer. (You may have fewer or more cores; I have 8 cores, so this leaves 50% free.) <strong>You should figure out how to use multiple cores on your machine</strong>.</p></li>
<li><p>Make numbers be printed only to 3 digits, for neater output:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="data" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="data"><span class="header-section-number">8.2</span> Data</h2>
<section id="sec-dd1-dyads" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="sec-dd1-dyads"><span class="header-section-number">8.2.1</span> Dyads</h3>
<p>Load the dyads dataset discussed in <span class="citation" data-cites="winter2021poisson">Winter and Bürkner (<a href="references.html#ref-winter2021poisson" role="doc-biblioref">2021</a>)</span>, which we used in <a href="week3.html" class="quarto-xref"><span>Chapter 2</span></a>:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dyads <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://osf.io/6j8kc/download"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The structure of the data is described in <a href="week3.html#sec-bb2-prelim" class="quarto-xref"><span>Section 2.1</span></a>, including descriptions of relevant columns.</p>
<!-- * "There are two data points per participant, one from the friend condition, and one from the professor condition. The `ID` column lists participant identifiers for all 27 participants (14 Catalan speakers and 13 Korean speakers). The `gestures` column contains the primary response variable that we are trying to model, the number of gestures observed on each trial. The `context` predictor specifies the social context that was experimentally manipulated." -->
<!-- Relevant columns: -->
<!-- * `ID`: participant -->
<!-- * `context`: friend vs. professor -->
<!--   * varies within-participant (2 observations per partiicpant) -->
<!-- * `language`: Catalan, Korean -->
<!--   * participant-level predictor -->
<!-- * `gender`: F, M -->
<!--   * participant-level predictor -->
<!-- *  `gestures`: gesture count -->
<!--   * response variable -->
<!-- * `dur`: duration of encounter -->
<p>We’ll assume below that the <strong>research questions</strong> are:</p>
<ol type="1">
<li>Do participants gesture more with professors than with friends?</li>
<li>Does this effect differ between Catalan and Korean speakers?</li>
</ol>
<p>Thus, these effects are of interest for the RQs:</p>
<ul>
<li><code>context</code>, <code>language</code>, <code>context</code>:<code>language</code></li>
</ul>
<p>All predictors are two-level factors. Transform to numeric and center:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dyads <span class="ot">&lt;-</span> dyads <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">context_prof =</span> <span class="fu">rescale</span>(context),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender_M =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(gender),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">language_K =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(language)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Empirical effects:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dyads <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> language, <span class="at">y =</span> gestures <span class="sc">/</span> dur)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> context)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Context"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Gestures"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Note:</p>
<ul>
<li>We plot the <em>rate</em> gestures/second: <code>gestures</code> divided by <code>dur</code>.</li>
<li>The <span class="math inline">\(y\)</span>-axis is on a log scale.</li>
</ul>
<p>Both correspond to the Poisson model we will fit, which models log counts (<code>log(gestures)</code>) using an offset for <code>log(dur)</code>.</p>
</section>
<section id="dutch-verb-etymology" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="dutch-verb-etymology"><span class="header-section-number">8.2.2</span> Dutch verb etymology</h3>
<p><code>etymology</code> from the languageR package. This is a dataset of “Estimated etymological age for regular and irregular monomorphemic Dutch verbs, together with other distributional predictors of regularity”, from <code>languageR</code>. The data is originally from <span class="citation" data-cites="tabak2005lexical">Tabak, Schreuder, and Baayen (<a href="references.html#ref-tabak2005lexical" role="doc-biblioref">2005</a>)</span>, and is analyzed in <span class="citation" data-cites="baayen2008ald">Baayen (<a href="references.html#ref-baayen2008ald" role="doc-biblioref">2008</a>)</span> 6.3.2.</p>
<p>Variables of interest:</p>
<ul>
<li>Response: <code>EtymAge</code> – how old a (Dutch) verb is, described as the age of the set of languages it shows up in (as a cognate)
<ul>
<li><em>Dutch</em> <span class="math inline">\(&lt;\)</span> <em>DutchGerman</em> <span class="math inline">\(&lt;\)</span> <em>WestGermanic</em> <span class="math inline">\(&lt;\)</span> <em>Germanic</em> <span class="math inline">\(&lt;\)</span> <em>IndoEuropean</em></li>
</ul></li>
<li>Predictors:
<ul>
<li><code>Regularity</code>: levels <em>irregular</em>, <em>regular</em> (0, 1)</li>
<li><code>WrittenFrequency</code>: centered</li>
<li><code>NcountStem</code>: centered</li>
</ul></li>
</ul>
<p>Preprocessing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>etymology <span class="ot">&lt;-</span> etymology <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## make EtymAge an ordered factor</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">EtymAge =</span> <span class="fu">ordered</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      EtymAge,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Dutch"</span>, <span class="st">"DutchGerman"</span>, <span class="st">"WestGermanic"</span>, <span class="st">"Germanic"</span>, <span class="st">"IndoEuropean"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Center continous vars</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">WrittenFrequency =</span> <span class="fu">scale</span>(WrittenFrequency, <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Center WrittenFrequency</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">NcountStem =</span> <span class="fu">scale</span>(NcountStem, <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Center and scale Regularity</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Regularity.std =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(Regularity),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(etymology<span class="sc">$</span>Regularity) <span class="ot">&lt;-</span> contr.helmert</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Different ways to visualize empirical effects for ordinal data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> etymology <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EtymAge, <span class="at">y =</span> WrittenFrequency)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> etymology <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> EtymAge, <span class="at">x =</span> NcountStem)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>etymology <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EtymAge)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">color =</span> Regularity, <span class="at">fill =</span> Regularity), <span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count", aes(color = Regularity, fill =</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity), : Ignoring unknown parameters: `binwidth`, `bins`, and `pad`</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram by quantile of NcountStem</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>etymology <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EtymAge)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">cut2</span>(NcountStem, <span class="at">g =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># proportions</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> etymology <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> EtymAge, <span class="at">fill =</span> Regularity)) <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Empirical CDF: requires converting EtymAge to numeric</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(etymology, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(EtymAge))) <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>, <span class="fu">aes</span>(<span class="at">color =</span> Regularity)) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"EtymAge"</span>) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> p4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>It seems like lower frequency, lower neighborhood density (<code>NcountStem</code>), and being regular are associated with a verb being younger (closer to <em>Dutch</em>).</p>
</section>
<section id="idioms" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="idioms"><span class="header-section-number">8.2.3</span> Idioms</h3>
<p>This data is originally from <span class="citation" data-cites="reddy2011empirical">Reddy, McCarthy, and Manandhar (<a href="references.html#ref-reddy2011empirical" role="doc-biblioref">2011</a>)</span>, a study of what factors influence perception of `how literal’ a compound noun is (like “smoking jacket”, “cutting edge”).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Traditionally compounds are classified as “idioms” or “compositional”, but in reality this is a fuzzy boundary.</p>
<p>The compounds can be roughly thought of as three types (column <code>literal_meaning</code>):</p>
<ol type="1">
<li><em>yes</em> – compound has a literal as well as idiomatic meaning (“melting pot”)</li>
<li><em>no</em> – compound does not have a (plausible) literal meanng (“front runner”)</li>
<li><em>none</em> – compound only has a literal meaning (“credit card”)</li>
</ol>
<p>Important columns, after processing done below:</p>
<ul>
<li><code>participant</code>: 151 participants</li>
<li><code>score</code>: rating (1-6 scale) given by participant to this <span class="math inline">\(N_1\)</span>-<span class="math inline">\(N_2\)</span> compound noun.</li>
<li><code>freq_word_1</code>: frequency (log-transformed) of <span class="math inline">\(N_1\)</span></li>
<li><code>freq_word_2</code>: frequency (log-transformed) of <span class="math inline">\(N_2\)</span></li>
<li><code>freq_word_3</code>: frequency (log-transformed) of <span class="math inline">\(N_1\)</span>+<span class="math inline">\(N_2\)</span> compound</li>
<li><code>word</code>: the <span class="math inline">\(N_1\)</span>+<span class="math inline">\(N_2\)</span> compound (90 compounds)</li>
<li><code>literal_meaning</code>: see above (factor with 3 levels)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/idioms_reddy.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s assume the research questions are:</p>
<ul>
<li>Do the frequencies of the individual nouns (<code>freq_word_1</code>, <code>freq_word_2</code>) affect <code>score</code>?</li>
<li>Does the frequency of the N+N compound (<code>freq_compound</code>) affect <code>score</code>?</li>
</ul>
<p>Some processing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## add 0.1 to all frequencies to avoid zero counts</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">## log-transform then standardize each frequency measure</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## change score to 1-6 ordinal scale</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>idioms <span class="ot">&lt;-</span> idioms <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq_word_1 =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">log</span>(Word1_freq <span class="sc">+</span> <span class="fl">0.1</span>)),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq_word_2 =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">log</span>(Word2_freq <span class="sc">+</span> <span class="fl">0.1</span>)),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq_compound =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">log</span>(Cpd_freq <span class="sc">+</span> <span class="fl">0.1</span>)),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(<span class="fu">str_match</span>(participant, <span class="st">"[0-9]+"</span>))),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">ordered</span>(score <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove ratings for N1 and N2 so we only have compound word ratings!</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="do">## The full dataset also has ratings of how literal N1 and N2 are.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>idioms <span class="ot">&lt;-</span> idioms <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">"_[0-9]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="do">## helmert coding for the 3-level factor</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(idioms<span class="sc">$</span>literal_meaning) <span class="ot">&lt;-</span> contr.helmert</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-cleaning" class="level4" data-number="8.2.3.1">
<h4 data-number="8.2.3.1" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">8.2.3.1</span> Data cleaning</h4>
<p>This data comes from Amazon Mechanical Turk, and is messy—not all participants are alike. There are 90 compounds, but most participants didn’t rate all compounds. Also, many participants didn’t use the whole 1-6 scale (e.g.&nbsp;just 2, 4, 6; or always chose 3). Let’s consider just those who rated at least 30 compounds and used the whole scale, as an approximation of “OK participant”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## partic who use the whole scale</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> idioms <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(score) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">ct =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ct <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(participant) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## partic who rated at least 30 words</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which</span>(<span class="fu">xtabs</span>(<span class="sc">~</span>participant, idioms) <span class="sc">&gt;</span> <span class="dv">30</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>good_participants <span class="ot">&lt;-</span> <span class="fu">intersect</span>(p1, p2)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>idioms <span class="ot">&lt;-</span> idioms <span class="sc">%&gt;%</span> <span class="fu">filter</span>(participant <span class="sc">%in%</span> good_participants)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are 23 OK participants.</p>
<p>Basic empirical effects:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> freq_word_1)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Word 1 frequency"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> freq_word_2)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Word 2 frequency"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> freq_compound)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Compound frequency"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>literal_meaning, <span class="at">scale =</span> <span class="st">"free_y"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Response pattern by participant:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>participant, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Participants"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Pattern by word, for the first 30 N-N compounds:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(word <span class="sc">%in%</span> <span class="fu">unique</span>(idioms<span class="sc">$</span>word)[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>word, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Compounds"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>It looks like participants differ in their response patterns. Note in particular how some participants have “wider” distribtions (like 191), suggesting that participants differ not just in the “intercept” but the “variance” of the distribution.</p>
<p>Words (= N+N compounds) also differ in their response patterns, but in a simpler way. The whole distribution is shifted more left or right; it’s not as clear that its “variance” differs by-word.</p>
</section>
</section>
<section id="dutch-verb-regularity" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="dutch-verb-regularity"><span class="header-section-number">8.2.4</span> Dutch verb <code>regularity</code></h3>
<p>This is a dataset on Dutch verb regularity from <code>languageR</code>. Preprocessing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## relevel Auxiliary to intuitive order,</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## center WrittenFrequency</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  make a numeric + centered version of Regularity:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>regularity <span class="ot">&lt;-</span> regularity <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Auxiliary =</span> <span class="fu">fct_relevel</span>(regularity<span class="sc">$</span>Auxiliary, <span class="st">"hebben"</span>, <span class="st">"zijnheb"</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">WrittenFrequency =</span> <span class="fu">scale</span>(WrittenFrequency, <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Regularity.num =</span> arm<span class="sc">::</span><span class="fu">rescale</span>(Regularity)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll assume:</p>
<ul>
<li>Response: <code>Auxiliary</code> (3 levels)</li>
<li>Predictors: <code>Regularity</code>, <code>WrittenFrequency</code></li>
</ul>
<p>Intuitively: “default” auxiliary (<em>hebben</em>) associated with lower <code>frequency</code> and regular verbs (<code>Regularity</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> regularity <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> WrittenFrequency, <span class="at">x =</span> Auxiliary)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> regularity <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Auxiliary, <span class="at">y =</span> <span class="fu">as.numeric</span>(Regularity) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">"mean_cl_boot"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Proportion Regularity=regular"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="poisson-and-negative-binomial-mixed-effects-models" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="poisson-and-negative-binomial-mixed-effects-models"><span class="header-section-number">8.3</span> Poisson and negative binomial mixed-effects models</h2>
<section id="sec-dd1-poisson" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="sec-dd1-poisson"><span class="header-section-number">8.3.1</span> Poisson</h3>
<p>We would like to fit a mixed-effects model for the <code>dyads</code> data testing the RQs above. See below for the model formula.</p>
<p>We would like to fit a mixed-effects model testing the RQs above. This is similar to <a href="week4.html#exr-brm1-extra-poisson" class="quarto-xref">Exercise&nbsp;<span>3.6</span></a>, but:</p>
<ul>
<li>Including random effects</li>
<li>Including an <code>offset</code> term</li>
</ul>
<p>Both better reflect the structure of this data.</p>
<p>To choose weakly informative priors, let’s consider the range of the data, after accounting for the <code>offset</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(<span class="fu">log</span>(dyads<span class="sc">$</span>gestures) <span class="sc">-</span> <span class="fu">log</span>(dyads<span class="sc">$</span>dur))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -2.355032 -0.513021</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>dyads <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(gestures) <span class="sc">-</span> <span class="fu">log</span>(dur))) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log(gestures) - offset"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="do">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Let’s do:</p>
<ul>
<li>Intercept: <span class="math inline">\(\beta_0 \sim N(-1, 0.5)\)</span>
<ul>
<li>Chosen so that mean +- 3 SD covers about the range of the data.</li>
</ul></li>
</ul>
<p>On log scale, 1 would be a very large effect, corresponding to multiplying <code>gestures</code> by exp(1) = 2.7, so let’s choose a regularizing prior s.t. 3 SD is 1:</p>
<ul>
<li><span class="math inline">\(\beta_i\)</span> slopes: <span class="math inline">\(\beta_i \sim N(0, 0.33)\)</span></li>
</ul>
<p>Random effects: reasonable scales, given priors we’ve chosen above, are 0.5 and 0.33 for slope/intercept. Let’s use 0.5 to be more conservative (flatter prior):</p>
<ul>
<li>Random effect variances: <span class="math inline">\(\sigma_i \sim \text{Exponential}(2)\)</span> = 1/0.5</li>
<li>Random effect correlations: <span class="math inline">\(LKJ(2)\)</span></li>
</ul>
<p>We use an offset term, <code>log(dur)</code>. <!-- That messes up intercepts above, have to change prior. --></p>
<p>Following the tutorial, I’ll increase the <code>iter</code>/<code>warmup</code> values from their defaults.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dyads_m12_1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  gestures <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">*</span> language_K <span class="sc">+</span> gender_M <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">offset</span>(<span class="fu">log</span>(dur)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">|</span> ID),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dyads, <span class="at">family =</span> poisson,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept), <span class="co"># beta_0</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.33</span>), <span class="at">class =</span> b),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">2</span>), <span class="at">class =</span> sd), <span class="co"># random-effect SDs</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">8000</span>, <span class="at">warmup =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/dyads_m12_1.brm"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dyads_m12_1)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: poisson </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = log </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: gestures ~ 1 + context_prof * language_K + gender_M + offset(log(dur)) + (1 + context_prof | ID) </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: dyads (Number of observations: 54) </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 8000; warmup = 4000; thin = 1;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 16000</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Multilevel Hyperparameters:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ~ID (Number of levels: 27) </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                   0.39      0.06     0.28     0.53 1.00     4615</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(context_prof)                0.15      0.07     0.01     0.29 1.00     4286</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,context_prof)     0.32      0.32    -0.40     0.84 1.00    12191</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Tail_ESS</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                   8251</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(context_prof)                4544</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,context_prof)    10098</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                  -1.03      0.08    -1.18    -0.88 1.00     3463</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof               -0.11      0.05    -0.22    -0.01 1.00     9501</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="do">## language_K                 -0.06      0.14    -0.34     0.21 1.00     4010</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="do">## gender_M                   -0.08      0.14    -0.35     0.19 1.00     4017</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof:language_K    -0.14      0.10    -0.33     0.05 1.00     9811</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Tail_ESS</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                   6433</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof               10437</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="do">## language_K                  6577</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="do">## gender_M                    6106</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof:language_K     9926</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exr-dd1-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.1</strong></span> &nbsp;</p>
<ol type="a">
<li><p>Consider the output of <code>dyads_m12_1</code>. Two rows of the regression table address RQ1 and RQ2. Which rows?</p></li>
<li><p>Calculate Bayes Factors, using <code>bf_pointnull</code>, for the model. What do the BFs, together with the 95% CredI’s from the model output for the two rows, say about RQ1 and RQ2?</p></li>
<li><p>Calculate the 95% CredI’s for the <code>context</code> effect when <code>language</code>=korean and when <code>language</code>=catalan. (You could use functionality from <code>emmeans</code> or <code>brms::hypothesis</code>, as demonstrated in the tutorial.). Does this change your interpretation from part (a)?</p></li>
</ol>
<p>Code for calculating the posteriors for these effects the easy way with emmeans`, and “by hand” the harder way (but more nicely visualized), is commented-out.</p>
<!-- The easy way: -->
<!-- ```{r} -->
<!-- pairs(emmeans(dyads_m12_1, ~ context_prof | language_K)) -->
<!-- ``` -->
<!-- ```{r, eval = FALSE} -->
<!-- ## draw predictionc -->
<!--  dyads %>% data_grid(context_prof, language_K, dur=mean(dur), gender_M=0) %>% add_epred_draws(dyads_m12_1, re_formula = NA, ndraws = 1000)  -> pred_df -->
<!-- ## change context, language to factors, for plotting -->
<!-- pred_df <- pred_df %>% mutate(context=factor(context_prof), language=factor(language_K)) -->
<!-- levels(pred_df$context) <- levels(dyads$context) -->
<!-- levels(pred_df$language) <- levels(dyads$language) -->
<!-- ## make plot of posterior -->
<!-- pred_df %>% pivot_wider(id_cols = c(.draw, language), names_from = c(context), values_from =.epred) %>% -->
<!--   mutate(diff = friend-prof) %>% -->
<!--   ggplot(aes(x = diff, y=language)) + -->
<!--   stat_slab() + geom_vline(aes(xintercept=0), lty=2) + xlab("Predicted prof/friend difference (counts)") -->
<!-- ``` -->
</div>
<!-- Essentially, Korean students gesture more with friends than professors; for Catalan students there isn't a clear difference. -->
<!-- As another example, which helps show "model" vs "natural" scale, this is the posterior for the `context` effect, for an average speaker, as `dur` is changed: -->
<!-- ```{r} -->
<!-- dyads %>%  -->
<!--   data_grid(dur=seq_range(dur, n = 50), context_prof, language_K=0, gender_M=0) %>% -->
<!--   add_epred_draws(dyads_m12_1, ndraws = 1000, re_formula=NA) %>% -->
<!--   pivot_wider(id_cols = c(.draw, dur), names_from = context_prof, values_from =.epred, names_prefix='context_prof') %>% -->
<!--   mutate(diff = `context_prof-0.5` - `context_prof0.5`) %>% -->
<!--   ggplot(aes(x = dur)) + -->
<!--  stat_lineribbon(aes(y = diff)) + -->
<!--   scale_fill_brewer(palette = "Greys") + -->
<!--   scale_color_brewer(palette = "Set2") + ylab("Pred. prof/friend difference (count)") + xlab("Duration") -->
<!-- ``` -->
<!-- Same, on model scale. -->
<!-- ```{r} -->
<!-- dyads %>%  -->
<!--   data_grid(dur=seq_range(dur, n = 50), context_prof, language_K=0, gender_M=0) %>% -->
<!--   add_linpred_draws(dyads_m12_1, ndraws = 100, re_formula=NA) %>% -->
<!--   pivot_wider(id_cols = c(.draw, dur), names_from = context_prof, values_from =.linpred, names_prefix='context_prof') %>% -->
<!--   mutate(diff = `context_prof-0.5` - `context_prof0.5`) %>% -->
<!--   ggplot(aes(x = dur)) + -->
<!--  stat_lineribbon(aes(y = diff)) + -->
<!--   scale_fill_brewer(palette = "Greys") + -->
<!--   scale_color_brewer(palette = "Set2") + ylab("Pred. prof/friend difference (log-count)") + xlab("Duration") + coord_cartesian(ylim=c(0,0.25)) -->
<!-- ``` -->
<p>We can perform a posterior predictive check, which suggests that the model isn’t overdispersed:</p>
<!-- Overdispersion not evident: -->
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(dyads_m12_1, <span class="at">ndraws =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>This makes sense, because the structure of the data means that the random-effect terms we’ve included are almost equivalent to including an offset <em>for each observation</em>.</p>
<p>To see the importance of the <code>offset</code> term, let’s fit the same model, just using default priors. (To choose weakly informative priors, we’d need to think about the distribution of <code>gestures</code>, without first subtracting <code>log(dur)</code>.) This is <strong>not</strong> a correct model—as the tutorial discusses, the offset is crucial—but it is instructive to see what effect this term has.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dyads_m12_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  gestures <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">*</span> language_K <span class="sc">+</span> gender_M <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">|</span> ID),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dyads, <span class="at">family =</span> poisson,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">8000</span>, <span class="at">warmup =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/dyads_m12_2.brm"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>dyads_m12_2</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: poisson </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = log </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: gestures ~ 1 + context_prof * language_K + gender_M + (1 + context_prof | ID) </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: dyads (Number of observations: 54) </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 8000; warmup = 4000; thin = 1;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 16000</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Multilevel Hyperparameters:</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ~ID (Number of levels: 27) </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                   0.53      0.09     0.39     0.72 1.00     4428</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(context_prof)                0.22      0.07     0.09     0.37 1.00     5545</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,context_prof)     0.41      0.27    -0.18     0.84 1.00    12218</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Tail_ESS</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                   8135</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(context_prof)                5416</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,context_prof)     8854</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                   3.79      0.10     3.58     3.99 1.00     3616</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof               -0.23      0.06    -0.35    -0.11 1.00     9995</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="do">## language_K                 -0.23      0.21    -0.64     0.19 1.00     3343</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="do">## gender_M                    0.06      0.20    -0.33     0.45 1.00     3622</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof:language_K    -0.36      0.12    -0.61    -0.12 1.00     9864</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Tail_ESS</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                   6080</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof               10718</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="do">## language_K                  5935</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="do">## gender_M                    6077</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof:language_K    10330</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exr-dd1-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.2</strong></span> &nbsp;</p>
<ol type="a">
<li><p>Just based on the model’s output: What results have changed from the model (<code>dyads_m12_1</code>) with the offset term? Qualitatively or quantitatively?</p></li>
<li><p>Make an empirical plot like in <a href="#sec-dd1-dyads" class="quarto-xref"><span>Section 8.2.1</span></a> but where the <span class="math inline">\(y\)</span>-axis is <code>gestures</code>, not <code>gestures/dur</code>. Can you see, comparing the two plots, why your results did or did not change between <code>dyads_m12_1</code> and <code>dyads_m12_2</code>?</p></li>
</ol>
</div>
</section>
<section id="negative-binomial" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="negative-binomial"><span class="header-section-number">8.3.2</span> Negative binomial</h3>
<p>The <code>dyads</code> data isn’t a good case for a negative binomial model because adding the random effects already takes care of overdispersion.</p>
<p>Instead, let’s return to the <code>wordbank</code> data from Homework 1 (<span class="quarto-unresolved-ref">?sec-hw1</span>), where the structure of the data is described:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wordbank_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"../../data/wordbank_data_hw1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll build a negative binomial model for all languages, using random effects, instead of just one language (as in <span class="quarto-unresolved-ref">?sec-hw1</span>). This model will also contain a couple interesting additional features.</p>
<p>First, some pre-processing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> wordbank_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## at least one language (Russian) has an extra lexical class (adverbs),</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## restrict to these four levels for comparability across languages</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lexical_class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"function_words"</span>, <span class="st">"verbs"</span>, <span class="st">"adjectives"</span>, <span class="st">"nouns"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## rows with missing values will be dropped when fitting the model anyway</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lexical_class) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(frequency) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(MLU) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(num_phons)) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## for convenience: total number of kids for this language</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_tot =</span> num_true <span class="sc">+</span> num_false) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## always run this after excluding all data with a given factor level</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## (here, lexical_class)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use a negative binomial model for this data, where:</p>
<ul>
<li><span class="math inline">\(y\)</span> = <code>num_true</code> is the response</li>
<li>The <code>offset</code> is <code>log(num_tot)</code>, because <span class="math inline">\(y\)</span> is not comparable across different languages, which summarize data from different numbers of children.</li>
</ul>
<p>We’ll use a negative binomial model because this is a good default for count data (as <span class="citation" data-cites="winter2021poisson">Winter and Bürkner (<a href="references.html#ref-winter2021poisson" role="doc-biblioref">2021</a>)</span> discuss).</p>
<p>Recall that for this data:</p>
<ul>
<li>The main effects of interest are <code>frequency</code> and <code>lexical_class</code>.<br>
</li>
<li><code>MLU</code> and <code>num_phons</code> are included as controls.</li>
</ul>
<p>We’ll allow the effects of <code>frequency</code> and <code>lexical_class</code> to differ by language, as they’re of primary interest. There is no conceptual reason to not use “maximal” random effect structure alloiwng other predictors’ effects to differ by language. We don’t do so here just so the model fits faster.</p>
<p>A negative binomial model allows for overdispersion using the <code>shape</code> parameter. The degree of overdispersion tends to differ between datasets, and it’s plausible that it would differ between <em>languages</em> here. We’ll allow for this by letting the <code>shape</code> parameter vary between languages, making this a case of distributional regression (<a href="week11.html#sec-brm3-dr" class="quarto-xref"><span>Section 7.3</span></a>), a <em>distributional mixed-effects negative binomial model</em> (whew!). The code for this is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>shape <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> language)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>0</code> is needed to keep the model from being overparametrized, for reasons I don’t totally understand (see discussion for ordinal models in <span class="citation" data-cites="burkner2019ordinal">Bürkner and Vuorre (<a href="references.html#ref-burkner2019ordinal" role="doc-biblioref">2019</a>)</span>),<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> which also require turning off how R treats <code>0</code> in model formulas by default, using the <code>cmc = FALSE</code> flag.</p>
<p>To fit this model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wordbank_m12_1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_all,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> negbinomial,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brmsformula</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    num_true <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(num_tot)) <span class="sc">+</span> frequency <span class="sc">+</span> lexical_class <span class="sc">+</span> MLU <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      num_phons <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> lexical_class <span class="sc">+</span> frequency <span class="sc">|</span> language),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    shape <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> language),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cmc =</span> <span class="cn">FALSE</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/wordbank_m12_1.brm"</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wordbank_m12_1</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: negbinomial </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = log; shape = log </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: num_true ~ offset(log(num_tot)) + frequency + lexical_class + MLU + num_phons + (1 + lexical_class + frequency | language) </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          shape ~ 0 + (1 | language)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: data_all (Number of observations: 2209) </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 8000</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Multilevel Hyperparameters:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~language (Number of levels: 9) </span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                                                     Estimate Est.Error l-95% CI</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                                           0.15      0.07     0.05</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classfunction_words)                         0.06      0.05     0.00</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classnouns)                                  0.09      0.04     0.02</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classverbs)                                  0.07      0.05     0.00</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(frequency)                                           0.01      0.01     0.00</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(shape_Intercept)                                     2.61      0.63     1.69</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classfunction_words)             -0.19      0.35    -0.78</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classnouns)                       0.05      0.32    -0.57</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classnouns)     0.08      0.35    -0.61</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classverbs)                      -0.04      0.34    -0.66</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classverbs)     0.05      0.36    -0.63</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,lexical_classverbs)              0.11      0.34    -0.58</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,frequency)                                0.21      0.35    -0.54</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,frequency)             -0.06      0.35    -0.69</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,frequency)                       0.08      0.34    -0.60</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classverbs,frequency)                       0.09      0.34    -0.59</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="do">##                                                     u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                                           0.32 1.00     2335</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classfunction_words)                         0.17 1.00     2436</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classnouns)                                  0.20 1.00     2625</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classverbs)                                  0.18 1.00     2635</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(frequency)                                           0.04 1.00     1796</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(shape_Intercept)                                     4.11 1.00     1469</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classfunction_words)              0.54 1.00     7200</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classnouns)                       0.66 1.00     6042</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classnouns)     0.70 1.00     4953</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classverbs)                       0.63 1.00     8018</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classverbs)     0.70 1.00     6764</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,lexical_classverbs)              0.71 1.00     5182</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,frequency)                                0.79 1.00     5279</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,frequency)              0.62 1.00     6153</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,frequency)                       0.71 1.00     6002</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classverbs,frequency)                       0.70 1.00     6348</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="do">##                                                     Tail_ESS</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                                           3680</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classfunction_words)                         4087</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classnouns)                                  2502</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(lexical_classverbs)                                  4163</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(frequency)                                           3293</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(shape_Intercept)                                     2624</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classfunction_words)              6070</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classnouns)                       5728</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classnouns)     6001</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,lexical_classverbs)                       5525</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,lexical_classverbs)     6716</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,lexical_classverbs)              5861</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,frequency)                                5884</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classfunction_words,frequency)              5939</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classnouns,frequency)                       6045</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(lexical_classverbs,frequency)                       6349</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                       0.52      0.09     0.35     0.70 1.00     5925</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="do">## frequency                       0.10      0.01     0.08     0.12 1.00     5029</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classfunction_words    -0.35      0.04    -0.44    -0.27 1.00     6532</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classnouns              0.33      0.04     0.25     0.41 1.00     4795</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classverbs              0.02      0.04    -0.06     0.10 1.00     5350</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="do">## MLU                            -0.06      0.01    -0.07    -0.05 1.00    11935</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a><span class="do">## num_phons                      -0.05      0.01    -0.06    -0.04 1.00    11705</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="do">##                             Tail_ESS</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept                       5320</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a><span class="do">## frequency                       4084</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classfunction_words     5697</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classnouns              4541</span></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a><span class="do">## lexical_classverbs              4832</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a><span class="do">## MLU                             6152</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="do">## num_phons                       5877</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model is sure that the degree of overdispersion differs between languages (which row of the model table shows this?). Estimated <code>shape</code> by language:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(wordbank_m12_1)<span class="sc">$</span>language[, , <span class="st">"shape_Intercept"</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                    Estimate  Est.Error     Q2.5    Q97.5</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Croatian           1.936425 0.15791380 1.624427 2.252422</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Danish             1.580384 0.09771266 1.384927 1.768805</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">## English (American) 2.467775 0.08303459 2.303834 2.626870</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">## French (Quebec)    1.926830 0.10691380 1.717689 2.134946</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Italian            2.768240 0.12506118 2.527791 3.011483</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Norwegian          2.239087 0.10422929 2.036964 2.443160</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Russian            3.212004 0.21137419 2.814662 3.644643</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Spanish (Mexican)  2.017617 0.10038822 1.819770 2.215731</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Turkish            2.923213 0.14966763 2.636315 3.225239</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In contrast, languages don’t clearly differ in the (linear) effect of frequency. Estimated effect by language:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(wordbank_m12_1)<span class="sc">$</span>language[, , <span class="st">"frequency"</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate  Est.Error       Q2.5     Q97.5</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Croatian           0.10363656 0.01440393 0.07856115 0.1370501</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Danish             0.10328881 0.01339693 0.07788560 0.1324924</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">## English (American) 0.10000720 0.01013044 0.08060470 0.1211183</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## French (Quebec)    0.10149031 0.01200997 0.07877119 0.1275285</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Italian            0.09130544 0.01151498 0.06664543 0.1116332</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Norwegian          0.11350370 0.01746606 0.08730528 0.1543931</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Russian            0.09062921 0.01565825 0.05231868 0.1160371</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Spanish (Mexican)  0.09556585 0.01246951 0.06692819 0.1173372</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Turkish            0.10228621 0.01356939 0.07517664 0.1297730</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is one way to show the predicted effect of <code>frequency</code> by language (for <code>nouns</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> data_all <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    language,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">seq_range</span>(frequency, <span class="at">n =</span> <span class="dv">100</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_phons =</span> <span class="fu">mean</span>(num_phons),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lexical_class =</span> <span class="st">"nouns"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">MLU =</span> <span class="fu">mean</span>(MLU),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_tot =</span> <span class="fu">mean</span>(num_tot)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">add_epred_draws</span>(wordbank_m12_1, <span class="at">newdata =</span> new_data, <span class="at">re_formula =</span> <span class="cn">NULL</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predictions, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> .epred, <span class="at">color =</span> language)) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Frequency"</span>, <span class="at">y =</span> <span class="st">"Predicted Number of True Items"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect of Frequency by Language"</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div id="exr-dd1-3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.3</strong></span> &nbsp;</p>
<ol type="a">
<li><p>Make a plot showing the predicted effect of <code>lexical_class</code> (<span class="math inline">\(x\)</span>-axis) for each language, holding other predictors constant.</p></li>
<li><p><em>Extra</em>: Make your plot more informative and accurate, as follows:</p></li>
</ol>
<ul>
<li>Include 95% CredI’s on predictions</li>
<li>Let MLU <code>num_phons</code>, <code>frequency</code>, and <code>num_total</code> have their average values <em>for a given language</em>, rather than across the whole dataset.</li>
<li>Anything else you can think of.</li>
</ul>
</div>
</section>
</section>
<section id="ordinal-models" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="ordinal-models"><span class="header-section-number">8.4</span> Ordinal models</h2>
<p>Laurestine made a nice visualization app <a href="https://www.desmos.com/calculator/zxaomefcny">here</a> to help understand (cumulative) ordinal models!</p>
<section id="sec-dd1-ordinal1" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="sec-dd1-ordinal1"><span class="header-section-number">8.4.1</span> Without random effects: <code>etymology</code></h3>
<p>We use the brms <code>cumulative</code> family, with default priors (for simplicity):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>etymology_m12_1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> etymology,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> cumulative,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  EtymAge <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> WrittenFrequency <span class="sc">+</span> NcountStem <span class="sc">+</span> Regularity,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/etymology_m12_1.brm"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(etymology_m12_1)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: cumulative </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = logit; disc = identity </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: EtymAge ~ 1 + WrittenFrequency + NcountStem + Regularity </span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: etymology (Number of observations: 285) </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 4000</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[1]         -4.13      0.39    -4.96    -3.41 1.00     1900     2148</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[2]         -2.44      0.23    -2.90    -2.00 1.00     3657     3275</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[3]         -1.42      0.20    -1.81    -1.04 1.00     3480     3121</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[4]          1.76      0.22     1.35     2.19 1.00     4900     3430</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency      0.08      0.07    -0.07     0.22 1.00     3887     3005</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="do">## NcountStem            0.05      0.02     0.01     0.10 1.00     3564     2510</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular    -0.83      0.24    -1.32    -0.36 1.00     3824     2775</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Further Distributional Parameters:</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="do">## disc     1.00      0.00     1.00     1.00   NA       NA       NA</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpreting some coefficients:</p>
<p>Cumulative probability up to each age:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(<span class="fu">prop.table</span>(<span class="fu">xtabs</span>(<span class="sc">~</span>EtymAge, <span class="at">data =</span> etymology)))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">##        Dutch  DutchGerman WestGermanic     Germanic IndoEuropean </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.02807018   0.12631579   0.27719298   0.88421053   1.00000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cumulative log-odds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">prop.table</span>(<span class="fu">xtabs</span>(<span class="sc">~</span>EtymAge, <span class="at">data =</span> etymology)))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logit</span>(temp)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">##        Dutch  DutchGerman WestGermanic     Germanic IndoEuropean </span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   -3.5445760   -1.9339340   -0.9584283    2.0329215          Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are similar to the “Intercepts” of the model.</p>
<p>Regularity effect:</p>
<ul>
<li>The log-odds of level <span class="math inline">\(k\)</span> vs level <span class="math inline">\(k-1\)</span> decreases by 0.41 for regular vs.&nbsp;irregular verbs.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> Regularity <span class="sc">+</span> EtymAge, <span class="at">data =</span> etymology)) <span class="ot">-&gt;</span> tab</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tab</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="do">##            EtymAge</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity        Dutch DutchGerman WestGermanic    Germanic IndoEuropean</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   irregular 0.003508772 0.038596491  0.059649123 0.322807018  0.073684211</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   regular   0.024561404 0.059649123  0.091228070 0.284210526  0.042105263</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lets examine the empirical values of this for different <span class="math inline">\(k\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## DutchGerman vs German</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(tab[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> tab[<span class="dv">2</span>, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">log</span>(tab[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">/</span> tab[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -1.510592</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## WestGermanic vs DutchGerman</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(tab[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">/</span> tab[<span class="dv">2</span>, <span class="dv">2</span>]) <span class="sc">-</span> <span class="fu">log</span>(tab[<span class="dv">1</span>, <span class="dv">3</span>] <span class="sc">/</span> tab[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.01043488</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="do">## etc.</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(tab[<span class="dv">2</span>, <span class="dv">4</span>] <span class="sc">/</span> tab[<span class="dv">2</span>, <span class="dv">3</span>]) <span class="sc">-</span> <span class="fu">log</span>(tab[<span class="dv">1</span>, <span class="dv">4</span>] <span class="sc">/</span> tab[<span class="dv">1</span>, <span class="dv">3</span>])</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.5522226</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(tab[<span class="dv">2</span>, <span class="dv">5</span>] <span class="sc">/</span> tab[<span class="dv">2</span>, <span class="dv">4</span>]) <span class="sc">-</span> <span class="fu">log</span>(tab[<span class="dv">1</span>, <span class="dv">5</span>] <span class="sc">/</span> tab[<span class="dv">1</span>, <span class="dv">4</span>])</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.4322764</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These values around -0.4 on average, but they seem to differ a lot across <span class="math inline">\(k\)</span>. This means the <em>proportional odds assumption</em> may not be satisfied. (There is surely a function to check for this more cleanly.) We can account for this by allowing a category-specific effect of <code>Regularity</code>, which is shown in <a href="#sec-dd1-extra-ordinal" class="quarto-xref"><span>Section 8.6.3</span></a>.</p>
<p>Let’s visualize the effects using marginal effect plots. (The coefficients are not easy to interpret directly.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(etymology_m12_1, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p><code>WrittenFrequency</code> doesn’t have a strong effect. A higher <code>NcountStem</code> decreases the probability of “smaller” <span class="math inline">\(y\)</span>, and increases the probability of “larger” <span class="math inline">\(y\)</span> (<em>IndoEuropean</em>). This follows from the positive sign of the coefficient: probability mass is shifted to higher <span class="math inline">\(y\)</span> values as the predictor is increased.</p>
<div id="exr-dd1-4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.4</strong></span> Interpret the <code>Regularity</code> coefficient, by filling in the following:</p>
<p>“The <code>Regularity</code> coefficient has ______ (positive/negative) sign. This means that probability mass is shifted to ____ (higher/lower) <span class="math inline">\(y\)</span> values for <em>Regular</em> verbs (= higher <code>Regularity</code>). That is, <em>Regular</em> verbs are predicted to be _____ (older/younger) than <em>Irregular</em> verbs.”</p>
</div>
<!-- The `Regularity` coefficient has the opposite sign, and does the opposite: probability mass is shifted to lower $y$ values for *Regular* verbs (higher `Regularity`). -->
<p>Use an empirical CDF posterior predictive check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(etymology_m12_1, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"ecdf_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>(An ECDF plot is preferred to the default <code>pp_check()</code> when <span class="math inline">\(y\)</span> is discrete.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>)</p>
<p>This looks fine.</p>
<!-- #### Posterior distribtuions for custom quantities -->
<!-- Another option for interpreting ordinal models, given the difficulty of interpreting their coefficients, is to calculate posterior distributions over a quantity of interest $X$ for interpreting the model with respect to research questions. -->
<!-- For example, $X$ might be: -->
</section>
<section id="ordinal-regression-with-random-effects" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="ordinal-regression-with-random-effects"><span class="header-section-number">8.4.2</span> Ordinal regression with random effects</h3>
<p>For the <code>idioms</code> data, a minimal model given the research questions (effect of all <code>freq</code> terms) should include by-participant random slopes for all <code>freq</code> terms. It should also include by-word random intercepts. Let’s fit this model, to the entire dataset, using LKJ(1.5) rather than the LKJ(1) default for random effect correlations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>idioms_m12_1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> idioms,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> cumulative,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> freq_word_1 <span class="sc">+</span> freq_word_2 <span class="sc">+</span> freq_compound <span class="sc">+</span> literal_meaning <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> freq_word_1 <span class="sc">+</span> freq_word_2 <span class="sc">+</span> freq_compound <span class="sc">|</span> participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> word),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="fl">1.5</span>), <span class="at">class =</span> cor)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/idioms_m12_1.brm"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(idioms_m12_1)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: cumulative </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = logit; disc = identity </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: score ~ 1 + freq_word_1 + freq_word_2 + freq_compound + literal_meaning + (1 + freq_word_1 + freq_word_2 + freq_compound | participant) + (1 | word) </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: idioms (Number of observations: 1623) </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 4000</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Multilevel Hyperparameters:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ~participant (Number of levels: 23) </span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                      0.92      0.16     0.66     1.30 1.00</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_1)                    0.17      0.12     0.01     0.44 1.00</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_2)                    0.25      0.15     0.02     0.57 1.00</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_compound)                  0.19      0.13     0.01     0.51 1.00</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_1)        -0.14      0.37    -0.79     0.62 1.00</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_2)        -0.01      0.34    -0.67     0.65 1.00</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_word_2)       0.13      0.40    -0.67     0.82 1.00</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_compound)      -0.20      0.37    -0.82     0.57 1.00</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_compound)     0.08      0.40    -0.69     0.78 1.00</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_2,freq_compound)     0.01      0.39    -0.72     0.74 1.00</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                                Bulk_ESS Tail_ESS</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                      1064     1716</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_1)                    1560     1704</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_2)                    1316     1755</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_compound)                  1939     2357</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_1)         5338     2810</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_2)         5493     2864</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_word_2)       2102     3018</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_compound)       4561     2700</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_compound)     3337     3086</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_2,freq_compound)     3927     3088</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ~word (Number of levels: 90) </span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     1.80      0.16     1.52     2.15 1.00     1035     1723</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[1]        -3.38      0.29    -3.95    -2.82 1.00      736     1318</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[2]        -1.71      0.28    -2.26    -1.16 1.00      718     1386</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[3]        -0.61      0.28    -1.15    -0.07 1.00      716     1220</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[4]         0.81      0.28     0.28     1.36 1.00      707     1367</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[5]         2.15      0.29     1.61     2.71 1.00      762     1440</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_word_1          0.43      0.43    -0.40     1.28 1.00      616     1071</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_word_2          0.04      0.43    -0.77     0.90 1.01      909     1334</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_compound        1.04      0.51     0.04     2.08 1.01      765     1056</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="do">## literal_meaning1     1.55      0.30     0.97     2.13 1.01      623     1098</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a><span class="do">## literal_meaning2    -0.88      0.16    -1.20    -0.58 1.00      703     1256</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Further Distributional Parameters:</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="do">## disc     1.00      0.00     1.00     1.00   NA       NA       NA</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>freq_compound</code> and <code>literal_meaning</code> have clear effects, while individual word frequencies do not (<code>freq_word_1</code>, <code>freq_word_2</code>).</p>
<!-- Note: I had to fit this, and the other model below, on a remote machine. On my laptop, each would take 15-60 min. -->
<!-- A minimal model given the research questions (effect of `frequency`) should include by-participant random slopes.  Let's fit this model, to the entire dataset, using LKJ(1.5) rather than the LKJ(1) default for random effect correlations: -->
<!-- ```{r} -->
<!-- idioms_m12_3 <- brm(data = idioms,  -->
<!--       family = cumulative, -->
<!--       score ~ 1 + freq_word_1 + freq_word_2 + freq_compound + literal_meaning + (1+freq_word_1 + freq_word_2 + freq_compound|participant), -->
<!--       prior = c( -->
<!--         prior(lkj(1.5), class=cor) -->
<!--       ), -->
<!--       iter = 2000, warmup = 1000, cores = 4, chains = 4, -->
<!--       file = "models/idioms_m12_3.brm") -->
<!-- ``` -->
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(idioms_m12_1, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-40-4.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Plotting model predictions by participant is a bit confusing, if we want to compare to empirical patterns. We consider predictions for an “average word”—a single observation—in two ways:</p>
<ol type="1">
<li>The distribution of predictions, by participant (= posterior predictive distribution)</li>
<li>The <em>fitted value</em>, by participant.</li>
</ol>
<p>What makes this confusing is that both look like histograms of values from 1-6. This is because the “fitted value” for a <em>single</em> observation is a vector of probabilities: the probability of each of categories 1–6. If you look closely at the two plots, you can see that the distributions in (1) are wider, for each participant. This is because on the latent scale, noise is added to the fitted value (plot (2)), resulting in a distribution which is slightly flattened out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(<span class="at">freq_word_1 =</span> <span class="dv">0</span>, <span class="at">freq_word_2 =</span> <span class="dv">0</span>, <span class="at">freq_compound =</span> <span class="dv">0</span>, <span class="at">literal_meaning =</span> <span class="st">"yes"</span>, participant) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(idioms_m12_1, <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">ndraws =</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>participant, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="do">## *average* prediction for an 'average word', by-participant.</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(<span class="at">freq_word_1 =</span> <span class="dv">0</span>, <span class="at">freq_word_2 =</span> <span class="dv">0</span>, <span class="at">freq_compound =</span> <span class="dv">0</span>, <span class="at">literal_meaning =</span> <span class="st">"yes"</span>, participant) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_epred_draws</span>(idioms_m12_1, <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">+</span> freq_word_1 <span class="sc">+</span> freq_word_2 <span class="sc">+</span> freq_compound <span class="sc">|</span> participant)) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.category, participant) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(.epred) <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .category, <span class="at">y =</span> .epred)) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">group =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>participant) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Note the mismatch match of plot (1) with the empirical data, where subjects see to differ in the “width” of the distribution, to the extent that some look bimodal while others look unimodal.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>We can also see this mismatch in a posterior predictive plot, grouped by subject:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(idioms_m12_1, <span class="at">type =</span> <span class="st">"ecdf_overlay_grouped"</span>, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">group =</span> <span class="st">"participant"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>(Subject 141, for example)</p>
<section id="distributional-model" class="level4" data-number="8.4.2.1">
<h4 data-number="8.4.2.1" class="anchored" data-anchor-id="distributional-model"><span class="header-section-number">8.4.2.1</span> Distributional model</h4>
<p>The simplest step to address this is to allow participants to differ in variance:<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>idioms_m12_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> idioms,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> cumulative,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bf</span>(score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> freq_word_1 <span class="sc">+</span> freq_word_2 <span class="sc">+</span> freq_compound <span class="sc">+</span> literal_meaning <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> freq_word_1 <span class="sc">+</span> freq_word_2 <span class="sc">+</span> freq_compound <span class="sc">|</span> participant) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> word)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lf</span>(disc <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">cmc =</span> <span class="cn">FALSE</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="fl">1.5</span>), <span class="at">class =</span> cor)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/idioms_m12_2.brm"</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variance is controlled by a parameter <code>disc</code>: variance = 1/<code>disc</code>. By default (in the model fitted above), it is fixed to 1. Because <code>disc</code> must be positive, if we model it (a case of distributional regression: <a href="week11.html#sec-brm3-dr" class="quarto-xref"><span>Section 7.3</span></a>), <code>brms</code> automatically puts the model in log space:</p>
<p><span class="math display">\[
\log(\text{disc}) = \text{(predictors)}
\]</span> The model sets <span class="math inline">\(\log(\text{disc})\)</span> to have mean zero (corresponding to <code>disc</code>=1), and participants vary (by-participant random effect). The <code>0 + (1|participant)</code> notation is important, and relates to the fact that we don’t want the <em>baseline</em> value of <code>disc</code> to be estimated—see the Burkner &amp; Vuorre tutorial <span class="citation" data-cites="burkner2019ordinal">(<a href="references.html#ref-burkner2019ordinal" role="doc-biblioref">Bürkner and Vuorre 2019</a>)</span>.</p>
<p>Note the extra term in the model summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(idioms_m12_2)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: cumulative </span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: mu = logit; disc = log </span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: score ~ 1 + freq_word_1 + freq_word_2 + freq_compound + literal_meaning + (1 + freq_word_1 + freq_word_2 + freq_compound | participant) + (1 | word) </span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          disc ~ 0 + (1 | participant)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: idioms (Number of observations: 1623) </span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 8000</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Multilevel Hyperparameters:</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ~participant (Number of levels: 23) </span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                      1.05      0.21     0.72     1.52 1.00</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_1)                    0.16      0.13     0.01     0.47 1.00</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_2)                    0.23      0.16     0.01     0.60 1.00</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_compound)                  0.34      0.20     0.02     0.77 1.00</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(disc_Intercept)                 0.40      0.08     0.28     0.59 1.00</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_1)        -0.09      0.38    -0.76     0.67 1.00</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_2)        -0.04      0.36    -0.72     0.66 1.00</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_word_2)       0.09      0.41    -0.71     0.81 1.00</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_compound)      -0.32      0.32    -0.83     0.39 1.00</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_compound)     0.10      0.40    -0.71     0.80 1.00</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_2,freq_compound)     0.03      0.39    -0.70     0.75 1.00</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="do">##                                Bulk_ESS Tail_ESS</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)                      1740     3100</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_1)                    3540     3759</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_word_2)                    2296     3192</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(freq_compound)                  2091     2221</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(disc_Intercept)                 1782     3076</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_1)         9278     5089</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_word_2)         8112     5303</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_word_2)       4868     5500</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(Intercept,freq_compound)       6611     5594</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_1,freq_compound)     4007     5157</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="do">## cor(freq_word_2,freq_compound)     4922     6015</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="do">## ~word (Number of levels: 90) </span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="do">## sd(Intercept)     2.06      0.27     1.61     2.68 1.00     1092     1772</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[1]        -3.95      0.50    -5.06    -3.09 1.00      825     1304</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[2]        -1.96      0.38    -2.75    -1.26 1.00      920     1970</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[3]        -0.69      0.33    -1.35    -0.03 1.00     1154     2066</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[4]         0.99      0.34     0.35     1.73 1.00     1418     2329</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[5]         2.59      0.42     1.83     3.52 1.00     1385     2010</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_word_1          0.52      0.50    -0.47     1.53 1.00     1319     1914</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_word_2          0.04      0.50    -0.96     1.02 1.00     1269     2066</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="do">## freq_compound        1.18      0.57     0.09     2.33 1.00     1827     3020</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="do">## literal_meaning1     1.71      0.37     1.02     2.49 1.00     1319     1996</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="do">## literal_meaning2    -1.00      0.20    -1.44    -0.64 1.00     1010     1503</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(idioms_m12_2, <span class="at">categorical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-45-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-45-4.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Distribution of predictions, by participant, for a single observation, like plot (1) for the previous model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>idioms <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_grid</span>(<span class="at">freq_word_1 =</span> <span class="dv">0</span>, <span class="at">freq_word_2 =</span> <span class="dv">0</span>, <span class="at">freq_compound =</span> <span class="dv">0</span>, <span class="at">literal_meaning =</span> <span class="st">"yes"</span>, participant) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(idioms_m12_2, <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">ndraws =</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .prediction)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>participant, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in geom_histogram(stat = "count"): Ignoring unknown parameters:</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="do">## `binwidth`, `bins`, and `pad`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Note how some participants are allowed to have “wider” distributions. This follows naturally from allowing variance to differ by-participant: high variance on the latent scale gives a “wider” distribution on the <span class="math inline">\(y\)</span> scale. It is hard to judge visually, but we can see which participants are predicted to have wider/narrow distributions by examining their predicted <code>disc</code> values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(idioms_m12_2)<span class="sc">$</span>participant[, , <span class="st">"disc_Intercept"</span>] <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Estimate) <span class="co"># sort by value</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">##         Estimate Est.Error        Q2.5        Q97.5</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 191 -0.947066453 0.1519010 -1.25949993 -0.666344650</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 141 -0.565839801 0.1644132 -0.90021768 -0.265309621</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 227 -0.506142006 0.1677428 -0.85512769 -0.197907410</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 185 -0.379219072 0.1602355 -0.70145440 -0.081895720</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 130 -0.305350542 0.2014921 -0.71506040  0.073489452</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 107 -0.284232571 0.1554955 -0.60984493  0.009503652</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 208 -0.251524300 0.1668371 -0.60027040  0.058852802</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 262 -0.242062327 0.1635689 -0.57177186  0.065343800</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 207 -0.136974556 0.1964239 -0.54086200  0.234382453</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 56  -0.122097207 0.1625797 -0.45204590  0.187810998</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 171 -0.115869132 0.1845028 -0.48317137  0.234947744</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 101 -0.024571300 0.1884720 -0.40192606  0.332648693</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 245  0.008732047 0.1580529 -0.31442829  0.309776164</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 142  0.047321507 0.1729586 -0.29785673  0.381205670</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 28   0.059414231 0.1483574 -0.23781241  0.349021356</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 170  0.076133128 0.1470500 -0.22530162  0.356171403</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 172  0.081753701 0.1405467 -0.20016283  0.351969050</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 96   0.089601536 0.1446953 -0.20506170  0.358193357</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 256  0.228295786 0.1509693 -0.07919182  0.516153133</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 46   0.230117956 0.1974157 -0.16383852  0.615569256</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 115  0.275342389 0.1503049 -0.03129318  0.567483722</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 244  0.484554076 0.2218011  0.05488517  0.929387860</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    0.584885794 0.1911085  0.21885161  0.971097714</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Participant 191 is predicted to have the widest distribution (because variance = 1/<code>disc</code>), and participant 5 the narrowest. This seems plausible from the empirical data.</p>
<p>Comparing LOO also suggests the more complex model is better:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(idioms_m12_1, idioms_m12_2, <span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Output of model 'idioms_m12_1':</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Computed from 4000 by 1623 log-likelihood matrix.</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate   SE</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">## elpd_loo  -2067.7 34.5</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="do">## p_loo       119.7  3.2</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="do">## looic      4135.5 69.0</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ------</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="do">## MCSE of elpd_loo is 0.2.</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="do">## MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 2.9]).</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="do">## All Pareto k estimates are good (k &lt; 0.7).</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="do">## See help('pareto-k-diagnostic') for details.</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Output of model 'idioms_m12_2':</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Computed from 8000 by 1623 log-likelihood matrix.</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate   SE</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="do">## elpd_loo  -1993.0 32.8</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="do">## p_loo       146.4  4.7</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="do">## looic      3986.0 65.6</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="do">## ------</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="do">## MCSE of elpd_loo is 0.2.</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="do">## MCSE and ESS estimates assume MCMC draws (r_eff in [0.6, 1.8]).</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="do">## All Pareto k estimates are good (k &lt; 0.7).</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="do">## See help('pareto-k-diagnostic') for details.</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Model comparisons:</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="do">##              elpd_diff se_diff</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="do">## idioms_m12_2   0.0       0.0  </span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="do">## idioms_m12_1 -74.7      13.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Model for all participants: -->
<!-- ```{r} -->
<!-- ## Takes a while to fit! -->
<!-- idioms_m12_4 <- brm(data = idioms, -->
<!--                     family = cumulative, -->
<!--                     score ~ 1 + freq_word_1 + freq_word_2 + freq_compound + literal_meaning + (1+freq_word_1 + freq_word_2 + freq_compound|participant), -->
<!--                     prior = c( -->
<!--                       prior(lkj(1.5), class=cor) -->
<!--                     ), -->
<!--                     iter = 2000, warmup = 1000, cores = 4, chains = 4, -->
<!--                     file = "models/idioms_m12_4.brm") -->
<!-- ``` -->
</section>
</section>
</section>
<section id="multinomial-models" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="multinomial-models"><span class="header-section-number">8.5</span> Multinomial models</h2>
<section id="without-random-effectgs-regularity" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="without-random-effectgs-regularity"><span class="header-section-number">8.5.1</span> Without random effectgs: <code>regularity</code></h3>
<p>Fit a basic multinoimial model to the <code>regularity</code> data, using brms’ default priors.</p>
<p>As always, you should think more carefully about these priors for a real analysis. This is trickier for multinomial regression than for logistic regression, as usefully discussed by <span class="citation" data-cites="barreda2023bayesian">Barreda and Silbert (<a href="references.html#ref-barreda2023bayesian" role="doc-biblioref">2023</a>)</span>, <a href="https://santiagobarreda.com/bmmrmd/multinomial-and-ordinal-regression.html#fitting-the-model">Sec. 12.2.5</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>regularity_m12_1 <span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> regularity,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">categorical</span>(<span class="at">link =</span> logit),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    Auxiliary <span class="sc">~</span> Regularity.num <span class="sc">+</span> WrittenFrequency,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"models/regularity_m12_1.brm"</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regularity_m12_1)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: categorical </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links: muzijnheb = logit; muzijn = logit </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: Auxiliary ~ Regularity.num + WrittenFrequency </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: regularity (Number of observations: 700) </span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 4000</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_Intercept           -1.78      0.11    -2.00    -1.57 1.00     4533</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_Intercept              -3.71      0.29    -4.35    -3.19 1.00     3129</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_Regularity.num      -0.96      0.26    -1.45    -0.46 1.00     4050</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_WrittenFrequency     0.01      0.06    -0.11     0.12 1.00     4240</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_Regularity.num         -1.60      0.52    -2.65    -0.58 1.00     2974</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_WrittenFrequency        0.14      0.12    -0.10     0.38 1.00     3699</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="do">##                            Tail_ESS</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_Intercept            2986</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_Intercept               2460</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_Regularity.num       3140</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijnheb_WrittenFrequency     3209</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_Regularity.num          2326</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="do">## muzijn_WrittenFrequency        2962</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Define:</p>
<ul>
<li><span class="math inline">\(y\)</span> = <code>Auxiliary</code> (values: 1, 2, 3 = <em>hebben</em>, <em>zijnheb</em>, <em>zijn</em>)</li>
<li><span class="math inline">\(p_1\)</span>, <span class="math inline">\(p_2\)</span>, <span class="math inline">\(p_3\)</span> are the probabilities of each <code>Auxiliary</code> value.</li>
<li><span class="math inline">\(x_1\)</span> is <code>WrittenFrequency</code></li>
<li><span class="math inline">\(x_2\)</span> is <code>Regularity.num</code></li>
</ul>
<p>Then the model, abstracting away from priors, is:</p>
<p><span class="math display">\[\begin{align}
\log(\frac{p_2}{p_1}) &amp; = \beta^{21}_0 + \beta^{21}_1 x_1 + \beta^{21}_2 x_2  \\
\log(\frac{p_3}{p_1}) &amp; = \beta^{31}_0 + \beta^{31}_1 x_1 + \beta^{31}_2 x_2 \\
p_1 + p_2 + p_3 &amp; = 1
\end{align}\]</span></p>
<p>The “score” for each outcome is:</p>
<p><span class="math display">\[\begin{align}
s_1 &amp; = 0 \\
s_2 &amp; = \beta^{21}_0 + \beta^{21}_1 x_1 + \beta^{21}_2 x_2 \\
s_3 &amp; = \beta^{31}_0 + \beta^{31}_1 x_1 + \beta^{31}_2 x_2
\end{align}\]</span></p>
<p>These can be used to write the relationship between linear predictors (=scores) and probabilities, in “softmax” form:</p>
<p><span class="math display">\[
p_i = \frac{\exp(s_i)}{\sum_{j=1}^{3}\exp(s_j)}
\]</span></p>
<p>Interpretation of some coefficients:</p>
<ul>
<li><code>muzijnheb_Intercept</code>: <span class="math inline">\(\beta_{0}^{21}\)</span>, the log-odds of <code>Auxiliary</code> = <em>zijnheb</em> vs.&nbsp;<em>hebben</em>, when <span class="math inline">\(x_1 = x_2 = 0\)</span>.
<ul>
<li>Because <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are centered, this should be roughly the same as “average log-odds of <code>Auxiliary</code> = <em>zijnheb</em> vs.&nbsp;<em>hebben</em> [across all data]”.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pt_aux <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">xtabs</span>(<span class="sc">~</span>Auxiliary, <span class="at">data =</span> regularity))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pt_aux</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Auxiliary</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     hebben    zijnheb       zijn </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.82428571 0.14714286 0.02857143</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(pt_aux[<span class="dv">2</span>] <span class="sc">/</span> pt_aux[<span class="dv">1</span>]) <span class="co"># about the same as "Estimate" column: ~-1.7</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   zijnheb </span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -1.723113</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>muzijn_Intercept</code>: <span class="math inline">\(\beta_{0}^{31}\)</span> similar, for “average log-odds of <code>Auxiliary</code> = <em>zijn</em> vs.&nbsp;<em>hebben</em> [across all data]”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(pt_aux[<span class="dv">3</span>] <span class="sc">/</span> pt_aux[<span class="dv">1</span>]) <span class="co"># about the same as "Estimate" column:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     zijn </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="do">## -3.36211</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>We can also compare to the predicted probabilities, using the “scores” formulation from above:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## these are the  "Estimate" values for muzijnheb_Intercept</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">## and muzijn_Intercept</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">fixef</span>(regularity_m12_1)[<span class="dv">1</span>, <span class="dv">1</span>], <span class="fu">fixef</span>(regularity_m12_1)[<span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="do">## this is the equation for p_i from above</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(scores) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(scores))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.83775206 0.14183738 0.02041056</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are similar to the empirical probabilities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>pt_aux</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Auxiliary</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     hebben    zijnheb       zijn </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.82428571 0.14714286 0.02857143</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>muzijnheb_Regularity.num</code>: <span class="math inline">\(\beta_{2}^{21}\)</span> the change in “log-odds of <code>Auxiliary</code> = <em>zijnheb</em> vs.&nbsp;<em>hebben</em>” between <code>Regularity</code>=regular and <code>Regularity</code>=irregular.
<ul>
<li>The <code>muzijnheb_</code> notation is because this is a coefficient of the logit model of <span class="math inline">\(\mu\)</span> for <em>zijnheb</em> vs.&nbsp;reference level, <em>hebben</em>.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pt_aux_reg <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> Regularity <span class="sc">+</span> Auxiliary, <span class="at">data =</span> regularity), <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>pt_aux_reg</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="do">##            Auxiliary</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity      hebben    zijnheb       zijn</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   irregular 0.67924528 0.24528302 0.07547170</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   regular   0.86691312 0.11829945 0.01478743</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Log-odds of zijnheb vs.&nbsp;hebben:</p>
<ul>
<li>Regularity=irregular: log(0.245/0.769) = -1.14</li>
<li>Regularity=regular: log(0.11829945/0.86691312) = -1.99</li>
</ul>
<p>Change in log-odds: -1.99 - -1.14 = -0.85</p>
<p>That’s similar to the <code>muzijnheb_Regularity.num</code> estimate. (It won’t be exactly the same, because the model also accounts for <code>WrittenFrequency</code>.)</p>
<p>This exercise hopefully demonstrates that interpreting the actual model coefficients is unintiitve. Instead it is better to understand fitted multinomial models by computing quantities of interest, and using these downstream—in effect plots, posterior examination, hypothesis tests, etc.</p>
<p>The equivalent frequentist model is shown in <span class="quarto-unresolved-ref">?sec-extra-dd1-multinomial</span>.</p>
<section id="plotting-effects" class="level4" data-number="8.5.1.1">
<h4 data-number="8.5.1.1" class="anchored" data-anchor-id="plotting-effects"><span class="header-section-number">8.5.1.1</span> Plotting effects</h4>
<p>Marginal effect of <code>WrittenFrequency</code> (averaging over <code>Regularity.num</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(regularity_m12_1, <span class="at">categorical =</span> <span class="cn">TRUE</span>, <span class="at">effects =</span> <span class="fu">c</span>(<span class="st">"WrittenFrequency"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>There is little frequency effect evident in this model, that also includes verb <code>Regularity</code>. (Note that regular verbs have higher frequency; presumably there would be a frequency effect in a model without <code>Regularity</code>.) This is consistent with the 95% CI for both <code>_WrittenFrequency</code> terms overlapping zero.</p>
<p>Marginal effect of <code>Regularity.num</code>, treated as a numeric predictor (so you need to imagine there are just two values):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(regularity_m12_1, <span class="at">categorical =</span> <span class="cn">TRUE</span>, <span class="at">effects =</span> <span class="fu">c</span>(<span class="st">"Regularity.num"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week12_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>To see marginal effects of <code>Regularity</code> treated as a factor requires more legwork. (Code commented out, and there is probably an easier way to do this.) Often it is easier to just refit your model using factors for discrete predictors, and use it to make prediction plots.</p>
<!-- ```{r, echo=FALSE} -->
<!-- ## set up dataframe to predict at -->
<!-- pred_df <- expand.grid(WrittenFrequency = 0, Regularity.num = unique(regularity$Regularity.num)) -->
<!-- # pred_df -->
<!-- ## predicted probability of each Auxiliary -->
<!-- predict(regularity_m12_1, newdata = pred_df) -->
<!-- ## draw predicted probabilities, for each Auxiliary, from posterior: -->
<!-- draws <- pred_df %>% add_epred_draws(regularity_m12_1) -->
<!-- draws -->
<!-- ## make Regularity.num a factor -->
<!-- draws$Regularity <- factor(draws$Regularity.num) -->
<!-- levels(draws$Regularity) <- c("irregular", "regular") -->
<!-- draws$Regularity.num <- NULL -->
<!-- draws %>% -->
<!--   group_by(WrittenFrequency, Regularity, .row, .category) %>% -->
<!--   median_qi() %>% -->
<!--   ggplot(aes(x = Regularity, y = .epred)) + -->
<!--   geom_pointinterval(aes(ymin = .lower, ymax = .upper, color = .category)) + -->
<!--   ylim(0, 1) + -->
<!--   ylab("Median + 95% CI posterior prob.") -->
<!-- ``` -->
<div id="exr-dd1-5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.5</strong></span> &nbsp;</p>
<ol type="a">
<li><p>Use <code>hypothesis()</code> to formally test whether either <code>WrittenFrequency</code> coefficient is larger than 0.</p></li>
<li><p>Make a plot showing the marginal effect of <code>Regularity</code>, treated as a factor.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p></li>
</ol>
</div>
</section>
</section>
</section>
<section id="extra" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="extra"><span class="header-section-number">8.6</span> Extra</h2>
<section id="frequentist-poisson-mixed-effects-model" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="frequentist-poisson-mixed-effects-model"><span class="header-section-number">8.6.1</span> Frequentist Poisson mixed-effects model</h3>
<p>Corresponding to <code>dyads_m12_1</code> in <a href="#sec-dd1-poisson" class="quarto-xref"><span>Section 8.3.1</span></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dyads_freq_m12 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(gestures <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">*</span> language_K <span class="sc">+</span> gender_M <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">offset</span>(<span class="fu">log</span>(dur)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> context_prof <span class="sc">|</span> ID), <span class="at">data =</span> dyads, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dyads_freq_m12, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Approximation) [glmerMod]</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: poisson  ( log )</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: </span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="do">## gestures ~ 1 + context_prof * language_K + gender_M + offset(log(dur)) +  </span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     (1 + context_prof | ID)</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: dyads</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      AIC      BIC   logLik deviance df.resid </span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="do">##    449.8    465.7   -216.9    433.8       46 </span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaled residuals: </span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="do">## -1.6686 -0.5031 -0.0188  0.4156  1.2748 </span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Random effects:</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups Name         Variance Std.Dev. Corr</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  ID     (Intercept)  0.12512  0.3537       </span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="do">##         context_prof 0.02234  0.1495   0.61</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of obs: 54, groups:  ID, 27</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Fixed effects:</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)             -1.03195    0.07154 -14.426   &lt;2e-16 ***</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof            -0.12537    0.05197  -2.412   0.0158 *  </span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="do">## language_K              -0.08378    0.14304  -0.586   0.5581    </span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="do">## gender_M                -0.07969    0.13416  -0.594   0.5525    </span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="do">## context_prof:language_K -0.15701    0.10019  -1.567   0.1171    </span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="frequentist-ordinal-model" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="frequentist-ordinal-model"><span class="header-section-number">8.6.2</span> Frequentist ordinal model</h3>
<p>Corresponding to model <code>etymology_m12_2</code> in <a href="#sec-dd1-ordinal1" class="quarto-xref"><span>Section 8.4.1</span></a>.</p>
<p>Fitted using <code>polr()</code> from MASS:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>etymology_freq_m12 <span class="ot">&lt;-</span> <span class="fu">polr</span>(EtymAge <span class="sc">~</span> WrittenFrequency <span class="sc">+</span> Regularity <span class="sc">+</span> NcountStem, <span class="at">data =</span> etymology, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(etymology_freq_m12)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="do">## polr(formula = EtymAge ~ WrittenFrequency + Regularity + NcountStem, </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     data = etymology, Hess = TRUE)</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Value Std. Error t value</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency  0.07756    0.07510   1.033</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity1      -0.41104    0.12364  -3.325</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="do">## NcountStem        0.05391    0.02088   2.581</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercepts:</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                          Value    Std. Error t value </span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Dutch|DutchGerman         -3.6682   0.3622   -10.1271</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="do">## DutchGerman|WestGermanic  -2.0193   0.1832   -11.0221</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="do">## WestGermanic|Germanic     -1.0037   0.1369    -7.3306</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Germanic|IndoEuropean      2.1527   0.1926    11.1783</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual Deviance: 644.6232 </span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 658.6232</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-dd1-extra-ordinal" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="sec-dd1-extra-ordinal"><span class="header-section-number">8.6.3</span> Ordinal model with category-specific effects</h3>
<p>Model with category-specific effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>etymology_m12_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> etymology,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> cumulative,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  EtymAge <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> WrittenFrequency <span class="sc">+</span> NcountStem <span class="sc">+</span> <span class="fu">cs</span>(Regularity),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"models/etymology_m12_2.brm"</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(etymology_m12_2)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Category specific effects for this family should be considered</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="do">## experimental and may have convergence issues.</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Family: cumulative </span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   Links:</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Category specific effects for this family should be considered</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="do">## experimental and may have convergence issues.</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="do">## mu = logit; disc = identity </span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: EtymAge ~ 1 + WrittenFrequency + NcountStem + cs(Regularity) </span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: etymology (Number of observations: 285) </span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="do">##          total post-warmup draws = 4000</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Regression Coefficients:</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[1]            -5.15      1.05    -7.65    -3.60 1.00     1312</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[2]            -2.47      0.30    -3.08    -1.92 1.00     2590</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[3]            -1.41      0.21    -1.83    -1.00 1.00     2984</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[4]             1.81      0.24     1.35     2.30 1.00     3307</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency         0.08      0.08    -0.07     0.23 1.00     3608</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="do">## NcountStem               0.05      0.02     0.01     0.10 1.00     3590</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[1]    -2.06      1.12    -4.62    -0.21 1.00     1361</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[2]    -0.85      0.37    -1.58    -0.15 1.00     2418</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[3]    -0.82      0.28    -1.36    -0.27 1.00     2592</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[4]    -0.73      0.41    -1.52     0.06 1.00     3333</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Tail_ESS</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[1]              982</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[2]             3017</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[3]             3278</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept[4]             3116</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency         2544</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="do">## NcountStem               2525</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[1]      850</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[2]     2642</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[3]     2225</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularityregular[4]     2900</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Further Distributional Parameters:</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="do">##      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="do">## disc     1.00      0.00     1.00     1.00   NA       NA       NA</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="do">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a><span class="do">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(If we choose to ignore the warnings:) There are now category-specific values of the <code>Regularity</code> coefficient, as for the <code>Intercept</code> (cutoffs). Note that all the <code>Regularity</code> coefficients have 95% CIs that overlap. This model does not seem to be an improvement over the previous one, which we can check by comparing LOO:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>etymology_m12_1 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(etymology_m12_1, <span class="st">"loo"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>etymology_m12_2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(etymology_m12_2, <span class="st">"loo"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(etymology_m12_1, etymology_m12_2)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                 elpd_diff se_diff</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="do">## etymology_m12_1  0.0       0.0   </span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="do">## etymology_m12_2 -2.3       2.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The simpler model is preferred.</p>
</section>
<section id="sec-dd1-extra-multinomial" class="level3" data-number="8.6.4">
<h3 data-number="8.6.4" class="anchored" data-anchor-id="sec-dd1-extra-multinomial"><span class="header-section-number">8.6.4</span> Frequentist multinomial model</h3>
<p>We follow <span class="citation" data-cites="levshina2015linguistics">Levshina (<a href="references.html#ref-levshina2015linguistics" role="doc-biblioref">2015</a>)</span> Chap. 13, using the mlogit package <span class="citation" data-cites="mlogit">(<a href="references.html#ref-mlogit" role="doc-biblioref">Croissant 2020</a>)</span>, to fit a frequentist multinoimal model to the <code>regularity data.</code></p>
<p>First, transform the data to the format required by <code>mlogit()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>regularity_2 <span class="ot">&lt;-</span> <span class="fu">mlogit.data</span>(regularity, <span class="at">shape =</span> <span class="st">"wide"</span>, <span class="at">choice =</span> <span class="st">"Auxiliary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>regularity_m12_freq <span class="ot">&lt;-</span> <span class="fu">mlogit</span>(<span class="at">formula =</span> Auxiliary <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Regularity.num <span class="sc">+</span> WrittenFrequency, <span class="at">data =</span> regularity_2, <span class="at">reflevel =</span> <span class="st">"hebben"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>reflevel</code> argument makes the sub-models compare the probabilties of the same <code>Auxiliary</code> levels as model <code>regularity_m12_1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regularity_m12_freq)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="do">## mlogit(formula = Auxiliary ~ 1 | Regularity.num + WrittenFrequency, </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     data = regularity_2, reflevel = "hebben", method = "nr")</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Frequencies of alternatives:choice</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   hebben     zijn  zijnheb </span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.824286 0.028571 0.147143 </span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="do">## nr method</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 iterations, 0h:0m:0s </span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="do">## g'(-H)^-1g = 2.23E-07 </span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="do">## gradient close to zero </span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients :</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="do">##                            Estimate Std. Error  z-value  Pr(&gt;|z|)    </span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept):zijn         -3.6740106  0.2886448 -12.7285 &lt; 2.2e-16 ***</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept):zijnheb      -1.7706302  0.1113882 -15.8960 &lt; 2.2e-16 ***</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity.num:zijn      -1.6108619  0.5248941  -3.0689 0.0021483 ** </span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Regularity.num:zijnheb   -0.9632617  0.2537025  -3.7968 0.0001466 ***</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency:zijn     0.1398767  0.1227794   1.1393 0.2545979    </span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="do">## WrittenFrequency:zijnheb  0.0054712  0.0598898   0.0914 0.9272110    </span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Log-Likelihood: -364.24</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="do">## McFadden R^2:  0.041447 </span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Likelihood ratio test : chisq = 31.499 (p.value = 2.4218e-06)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-baayen2008ald" class="csl-entry" role="listitem">
Baayen, R. H. 2008. <em><span class="nocase">Analyzing linguistic data: A practical introduction to statistics using R</span></em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-barreda2023bayesian" class="csl-entry" role="listitem">
Barreda, Santiago, and Noah Silbert. 2023. <em>Bayesian Multilevel Models for Repeated Measures Data: A Conceptual and Practical Introduction in r</em>. Taylor &amp; Francis. <a href="https://santiagobarreda.com/bmmrmd/" class="uri">https://santiagobarreda.com/bmmrmd/</a>.
</div>
<div id="ref-burkner2019ordinal" class="csl-entry" role="listitem">
Bürkner, Paul-Christian, and Matti Vuorre. 2019. <span>“Ordinal Regression Models in Psychology: A Tutorial.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 2 (1): 77–101.
</div>
<div id="ref-mlogit" class="csl-entry" role="listitem">
Croissant, Yves. 2020. <span>“Estimation of Random Utility Models in <span>R</span>: The <span class="nocase">mlogit</span> Package.”</span> <em>Journal of Statistical Software</em> 95 (11): 1–41. <a href="https://doi.org/10.18637/jss.v095.i11">https://doi.org/10.18637/jss.v095.i11</a>.
</div>
<div id="ref-kurz2021statistical" class="csl-entry" role="listitem">
Kurz, S. 2023. <em>Statistical Rethinking (Second Edition) with Brms, Ggplot2, and the Tidyverse</em>. <a href="https://bookdown.org/content/4857/" class="uri">https://bookdown.org/content/4857/</a>.
</div>
<div id="ref-levshina2015linguistics" class="csl-entry" role="listitem">
Levshina, Natalia. 2015. <em><span class="nocase">How to do linguistics with R: Data exploration and statistical analysis</span></em>. John Benjamins.
</div>
<div id="ref-mcelreath2020statistical" class="csl-entry" role="listitem">
McElreath, Richard. 2020. <em>Statistical Rethinking: A <span>B</span>ayesian Course with Examples in <span>R</span> and <span>S</span>tan</em>. Second. Chapman; Hall/CRC.
</div>
<div id="ref-reddy2011empirical" class="csl-entry" role="listitem">
Reddy, Siva, Diana McCarthy, and Suresh Manandhar. 2011. <span>“An Empirical Study on Compositionality in Compound Nouns.”</span> In <em>Proceedings of 5th International Joint Conference on Natural Language Processing</em>, 210–18.
</div>
<div id="ref-tabak2005lexical" class="csl-entry" role="listitem">
Tabak, Wieke M, Robert Schreuder, and R Harald Baayen. 2005. <span>“Lexical Statistics and Lexical Processing: Semantic Density, Information Complexity, Sex, and Irregularity in Dutch.”</span> In <em>Linguistic Evidence</em>, edited by Stephan Kepser and Marga Reis, 529–56. De Gruyter Mouton.
</div>
<div id="ref-winter2021poisson" class="csl-entry" role="listitem">
Winter, Bodo, and Paul-Christian Bürkner. 2021. <span>“Poisson Regression for Linguists: A Tutorial Introduction to Modelling Count Data with Brms.”</span> <em>Language and Linguistics Compass</em> 15 (11): e12439.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>I found their <a href="https://osf.io/ugpfd/">OSF project</a> helpful, especially the <a href="https://osf.io/eaxk7/">Rmd file</a> showing code.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>I thank Siva Reddy for posting this data, and <a href="https://michaelasocolof.github.io/">Michaela Socolof</a> for providing a cleaned-up version with word frequency information added. This dataset was analyzed for her LING 620 project.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I think what’s going on is that <code>log(shape)</code> already has a default value (0) implied by the structure of a negative binomial model, so each <code>language</code> can’t have an independent <code>shape</code> parameter estimated—their mean has to be zero. We need to force the model to just allow <code>log(shape)</code> to differ from its default value (0) for each language, while not fitting an additional overall <code>log(shape)</code> coefficient.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><span class="citation" data-cites="winter2021poisson">Winter and Bürkner (<a href="references.html#ref-winter2021poisson" role="doc-biblioref">2021</a>)</span>: “The <code>pp_check()</code> function allows a number of different visualisation types. Here we specify the argument <code>type = 'ecdf_overlay'</code> to return an empirical cumulative distribution func- tion (ECDF). By default, <code>pp_check()</code> returns a smoothed output which may be inappropriate for discrete data, such as count data.”<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Exercise: why will plot (2) never show this mismatch, and in fact we don’t expect it to look like the empirical data in terms of the <em>width</em> of participants’ distributions? This took me a while to realize.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Another step would be making the by-participant intercept category specific, but this means adding many more coefficients: 5 per participant.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Hint: Two ways to do this are to do some post-processing of the output of <code>conditional_effects()</code>, or just re-fit the model with <code>Regularity</code> coded as a factor.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week11.html" class="pagination-link" aria-label="Bayesian Hierarchical Models 3">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bayesian Hierarchical Models 3</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week13.html" class="pagination-link" aria-label="Multivariate models">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multivariate models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>